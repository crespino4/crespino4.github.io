"use strict";(self.webpackChunkgcx_media_switcher=self.webpackChunkgcx_media_switcher||[]).push([[4152],{4152:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var a=s(5043),i=s(9456),n=s(8955),d=s(3928),c=s(4492),o=s(3583),r=(s(175),s(579));(0,o.v)();const l=()=>{const[e,t]=a.useState([]),[s,o]=a.useState([]),[l,u]=a.useState([]),[h,p]=a.useState(void 0),[m,j]=a.useState(void 0),x=(0,i.d4)((e=>e.debugMode.value)),g=(0,i.d4)((e=>e.deploymentProperties.value.supportedMediaTypes)),y=(e,t)=>{const s=e.split("_");if(s.length>=3){const e=s[1].toLowerCase();return t.hasOwnProperty(e)?e:void 0}},S=(e,t)=>{let s=[];for(let a=0;a<e.length;a++){const i=e[a].name,n=e[a].joined,d=y(i,t);if(d){0==s.filter((e=>e.mediaType==d)).length&&s.push({mediaType:d,label:t[d],joinStatus:n})}}return s},f=async(t,a)=>{try{if((0,d.Z)(x,"Home:UpdateQueueStatus:Start - [".concat(t,"] queues to new status [").concat(a,"]")),h){let i=[];for(let n=0;n<e.length;n++){const d=e[n].name,c=e[n].id;y(d,s)==t&&i.push({id:c,joined:a})}await n.H.patchUserQueues(h,i),w(i),(0,d.Z)(x,"Home:UpdateQueueStatus:End",i)}else(0,d.Z)(x,"Home:UpdateQueueStatus:UnknownAgentId");j(void 0)}catch(i){(0,d.Z)(x,"Home:UpdateQueueStatus:Exception",i),j(i)}},w=a=>{let i=e;i=i.map((e=>{const t=a.filter((t=>t.id==e.id));return 1==t.length&&(e.joined=t[0].joined),e}));const n=S(i,s);u(n),t(i)};return(0,a.useEffect)((()=>{(0,d.Z)(x,"Home:Init - Initializing Media Switcher"),(async()=>{try{const e=await n.H.getCurrentUser();if(e.id){(0,d.Z)(x,"Home:Init:AgentID",e.id),p(e.id);const s=await n.H.getUserQueues(e.id);(0,d.Z)(x,"Home:Init:UserQueues",s),t(s),(0,d.Z)(x,"Home:Init:SupportedMediaTypes",g),o(g);const a=S(s,g);u(a),(0,d.Z)(x,"Home:Init:RelevantMediaTypes",a)}}catch(e){console.log(e),j(e)}})()}),[]),(0,r.jsxs)("div",{children:[m&&(0,r.jsxs)(c.CJ,{accent:"error",children:[m.code," - ",m.message]}),(0,r.jsx)("h1",{children:"Media Switcher"}),(0,r.jsx)(c.L,{className:"toggle-area",children:l.map((e=>(0,r.jsx)(c.hf,{checked:e.joinStatus,id:e.mediaType,checkedLabel:e.label,uncheckedLabel:e.label,onCheck:t=>((e,t)=>{f(t,e.detail)})(t,e.mediaType)},e.mediaType)))}),(0,r.jsx)(c.PY,{compact:!0,className:"queue-status",hidden:!x,children:(0,r.jsxs)("table",{slot:"data",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Queue"}),(0,r.jsx)("th",{children:"Joined"})]})}),(0,r.jsx)("tbody",{children:e.map((e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.joined?"Yes":"No"})]},e.id)))})]})})]})}}}]);
//# sourceMappingURL=4152.3bca14fa.chunk.js.map